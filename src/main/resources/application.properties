# =================================================================================
# ==================== CONFIGURACIÓN CENTRAL DE LA APLICACIÓN =====================
# =================================================================================
# Este archivo es el corazón de la configuración de Spring Boot. Aquí se definen
# todas las propiedades necesarias para que la aplicación se conecte a la base
# de datos, se comporte correctamente y se integre con otros servicios.
# =================================================================================


# =================================================================================
# ========= SECCIÓN 1: CONFIGURACIÓN DE LA FUENTE DE DATOS (DataSource) ===========
# =================================================================================
# Aquí se especifican los detalles para que Spring pueda conectarse a la base
# de datos MySQL.

# --- URL de Conexión JDBC ---
# Define la ubicación y los parámetros de la base de datos.
# - jdbc:mysql:// -> Protocolo para conectar con MySQL.
# - 127.0.0.1:3306 -> Se usa la IP explícita en lugar de 'localhost' para forzar la conexión
#   a través del stack de red TCP/IP, evitando posibles problemas con el socket de Unix.
#   El puerto 3306 es el puerto por defecto de MySQL.
# - /lockstrm_db -> Nombre de la base de datos a la que nos conectaremos.
# - createDatabaseIfNotExist=true -> Parámetro muy útil para el desarrollo. Si la base de datos
#   'lockstrm_db' no existe al arrancar, el driver de MySQL la creará automáticamente.
# - useSSL=false -> Deshabilita el cifrado SSL para la conexión. Aceptable para desarrollo local.
#   En producción, debería ser 'true' con una configuración de certificados adecuada.
# - allowPublicKeyRetrieval=true -> Necesario en versiones modernas del driver de MySQL cuando
#   no se usa SSL, para permitir que el cliente obtenga la clave pública del servidor.
spring.datasource.url=jdbc:mysql://127.0.0.1:3306/lockstrm_db?createDatabaseIfNotExist=true&useSSL=false&allowPublicKeyRetrieval=true

# --- Credenciales de la Base de Datos ---
# Usuario y contraseña para autenticarse en el servidor de MySQL.
# Es una mala práctica tener contraseñas en texto plano en control de versiones.
# Para producción, se deben externalizar usando variables de entorno o Spring Cloud Config.
spring.datasource.username=lockstrm_user
spring.datasource.password=pass

# --- Driver JDBC ---
# Clase del driver que Spring Boot usará para comunicarse con MySQL.
# 'com.mysql.cj.jdbc.Driver' es el driver moderno para MySQL 8+.
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver


# =================================================================================
# ========= SECCIÓN 2: CONFIGURACIÓN DE JPA E HIBERNATE (ORM) =====================
# =================================================================================
# JPA (Java Persistence API) es el estándar para el mapeo objeto-relacional (ORM).
# Hibernate es la implementación de JPA que usamos.

# --- Estrategia de Generación del Esquema (DDL - Data Definition Language) ---
# Define cómo Hibernate gestiona el esquema de la base de datos al arrancar.
# - 'update': Es la opción más común para desarrollo. Hibernate compara las entidades
#   (@Entity) del código Java con las tablas de la base de datos y aplica los cambios
#   necesarios (añade columnas, crea tablas, etc.), pero SIN borrar datos existentes.
# - 'create': Borra y recrea el esquema completo cada vez. Útil para pruebas, se pierden todos los datos.
# - 'create-drop': Igual que 'create', pero además borra el esquema al cerrar la aplicación.
# - 'validate': Valida que el esquema de la BBDD coincida con las entidades, pero no hace cambios.
# - 'none': No hace nada. Es la opción recomendada para producción, donde el esquema se
#   gestiona con herramientas de migración como Flyway o Liquibase.
spring.jpa.hibernate.ddl-auto=update

# --- Dialecto de la Base de Datos ---
# Informa a Hibernate sobre la "variedad" específica de SQL que debe generar.
# 'MySQL8Dialect' asegura que se use la sintaxis correcta para MySQL 8 y superior,
# aprovechando sus características específicas.
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect

# --- Mostrar SQL en Consola ---
# 'true': Imprime en la consola todas las sentencias SQL que Hibernate genera y ejecuta.
# Es extremadamente útil para depurar y entender qué está haciendo el ORM por debajo.
# Puede hacer que los logs sean muy verbosos, por lo que a menudo se deshabilita
# en producción o se configura para un nivel de log más específico (DEBUG).
spring.jpa.show-sql=true
